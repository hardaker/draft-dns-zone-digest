<?xml version='1.0' encoding='UTF-8' ?> 

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!-- One method to get references from the online citation libraries.
There has to be one entity for each item to be referenced. 
An alternate method (rfc include) is described in the references. -->
<!ENTITY RFC5966 SYSTEM "http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.5966.xml">
<!ENTITY I-D.ietf-tcpm-fastopen SYSTEM "http://xml2rfc.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-tcpm-fastopen">
<!ENTITY I-D.draft-ietf-dnsop-edns-tcp-keepalive SYSTEM "http://xml2rfc.ietf.org/public/rfc/bibxml3/reference.I-D.draft-ietf-dnsop-edns-tcp-keepalive-00.xml">
<!ENTITY RFC0768 PUBLIC '' "http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.0768.xml">
<!ENTITY RFC0793 PUBLIC '' "http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.0793.xml">
<!ENTITY RFC1034 PUBLIC '' "http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.1034.xml">
<!ENTITY RFC1035 PUBLIC '' "http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.1035.xml">
<!ENTITY RFC1123 PUBLIC '' "http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.1123.xml">
<!ENTITY RFC2119 PUBLIC '' "http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC2119 PUBLIC '' "http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC2616 PUBLIC '' "http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.2616.xml">
<!ENTITY RFC2629 PUBLIC '' "http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.2629.xml">
<!ENTITY RFC2671 PUBLIC '' "http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.2671.xml">
<!ENTITY RFC2920 PUBLIC '' "http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.2920.xml">
<!ENTITY RFC3552 PUBLIC '' "http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.3552.xml">
<!ENTITY RFC4033 PUBLIC '' "http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4033.xml">
<!ENTITY RFC4034 PUBLIC '' "http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4034.xml">
<!ENTITY RFC4035 PUBLIC '' "http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4035.xml">
<!ENTITY RFC5011 PUBLIC '' "http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.5011.xml">
<!ENTITY RFC5155 PUBLIC '' "http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.5155.xml">
<!ENTITY RFC5358 PUBLIC '' "http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.5358.xml">
<!ENTITY RFC5625 PUBLIC '' "http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.5625.xml">
<!ENTITY RFC5625 PUBLIC '' "http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.5625.xml">
<!ENTITY RFC6824 PUBLIC '' "http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6824.xml">
<!ENTITY RFC6891 PUBLIC '' "http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6891.xml">
<!ENTITY RFC7230 PUBLIC '' "http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7230.xml">
<!ENTITY RFC7323 PUBLIC '' "http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7323.xml">
<!ENTITY RRNAME "ZHASH">
]>


<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>
<?rfc strict="yes" ?>
<?rfc toc="yes"?>
<?rfc tocdepth="4"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes" ?>
<?rfc compact="yes" ?>
<?rfc subcompact="no" ?>

<rfc category="std" docName="draft-dns-zone-message-digest" ipr="trust200902">
  <!-- category values: std, bcp, info, exp, and historic
  ipr values: full3667, noModification3667, noDerivatives3667
  you can add the attributes updates="NNNN" and obsoletes="NNNN" 
  they will automatically be output with "(if approved)" -->

  <!-- ***** FRONT MATTER ***** -->

  <front>
    <!-- The abbreviated title is used in the page header - it is only necessary if the 
    full title is longer than 39 characters -->

    <title abbrev="dns-zone-message-digest">Message Digest for DNS Zones</title>

    <!-- add 'role="editor"' below for the editors if appropriate -->

    <!-- Another author who claims to be an editor -->

    <author fullname="Duane Wessels" initials="D." surname="Wessels">
      <organization>Verisign Labs</organization>
      <address>
        <postal>
          <street>12061 Bluemont Way</street>
          <city>Reston</city>
          <region>VA</region>
          <code>20190</code>
        </postal>
        <phone>+1 703 948-3200</phone>
        <email>dwessels@verisign.com</email>
        <uri>http://verisign.com</uri>
      </address>
    </author>

    <date month="March" year="2018" />

    <area>General</area>

    <workgroup>Internet Engineering Task Force</workgroup>

    <keyword>DNS</keyword>
    <keyword>DNSSEC</keyword>
    <keyword>Checksum</keyword>
    <keyword>Hash</keyword>
    <keyword>Zone Transfer</keyword>

    <abstract>
      <t>
        This document describes a protocol and DNS Resource Record
        used to provide a message digest over DNS zone data.
        In particular, it describes how to compute, sign, represent,
        and use the message digest to validate the contents of a
        zone for accuracy and completeness.
        The &RRNAME; Resource Record type is introduced for conveying
        the message digest data.
      </t>
    </abstract>
  </front>

  <middle>

    <section title="Introduction">
      <t>
        In the DNS, a zone is the collection of authoritative resource
        records (RRs) sharing a common origin (<xref target="RFC7719"/>),
	which can be distributed from primary to secondary name
	servers.
        Zones are often stored as files on disk in the so-called
        master file format <xref target="RFC1034"/>.
	Sometimes zones are distributed outside of the DNS, with
	such protocols as FTP, HTTP, rsync, and so on.
        While zone files are self-contained, currently there is
        no way to validate the authenticity of a stand-alone zone
        file.
        This document introduces a new RR type that serves as a
        cryptographic message digest of the data in a zone file.
	It allows a receiver of the zone file to validate its
	authenticity, especially when used in combination with DNSSEC.
      </t>
      <t>
        Message digests are also found in the TSIG protocol.
        DNS transaction signatures (TSIG, RFCXXX) uses a message
        digest to protect individual query and response messages.
        TSIG is generally used to authenticate and validate UPDATE
        and AXFR/IXFR messages.
        However, TSIG's protections are ephemeral, existing only "on
        the wire," are not retained after the transaction is complete.
        Additionally, TSIG utilizes shared secret keys, which
        are not available to third parties.
      </t>
      <t>
        The technique described in this document makes the message
        digest a part of the zone file itself, and allows anyone
        to validate the zone file as a whole, no matter how it is
        transmitted.
      </t>
      <t>
	The zone message digest relies on DNSSEC to provide strong
	security guarantees.  Without DNSSEC, an attacker can modify
	zone data and recalculate the message digest and not be detected.
	For discussion: currently this document does not require DNSSEC
	but the authors are open to changing that.
      </t>
    </section>

    <section title="Terminology">
      <t>
        The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
        "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
        document are to be interpreted as described in <xref
          target="RFC2119"/>.
      </t>
    </section>

    <section title="The &RRNAME; Resource Record" anchor="rrtype">
      <t>
        This section describes the &RRNAME; Resource Record, including its fields, wire format, presentation format.
      </t>

      <section title="&RRNAME; RDATA Wire Format">
        <t>The &RRNAME; RDATA wire format is encoded as follows:</t>
        <figure><artwork align="left"><![CDATA[
       +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
    0: |                                                               |
       |                            SERIAL                             |
       |                                                               |
       +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
    4: |                               |                               |
       |            DIGEST-TYPE        |                               | 
       |                               |                               |
       +---+---+---+---+---+---+---+---+        DIGEST-DATA            +
       /                                                               /
       /                                                               /
       /                                                               /
       +---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
]]></artwork></figure>
        <t>where:

   SERIAL: a 32-bit unsigned integer in network order, equal to the
   serial number from the zone's SOA record, as defined in section
   3.3.13 of <xref target="RFC1035"/>.

   For Discussion: the serial number is included in order to make
   DNS response messages of type &RRNAME; meaningful.  Without the
   serial number, a stand-alone &RRNAME; digest has no association
   to any particular zone file.  If &RRNAME; were to be made a
   so-called meta type that cannot be queried for (like OPT), then
   serial would not be necessary.

   DIGEST-TYPE: an 8-bit unsigned integer, with meaning equivalent to
   the DIGEST-TYPE of the DS RR type (<xref target="RFC4034"/>).

   DIGEST-DATA: Variable length sequence of octets containing the
   message digest.
        </t>
      </section>
      <section title="&RRNAME; Presentation Format">
        <t>
          The &RRNAME; RR presentation format is identical to the DS RR format:
        </t>
        <t>
          &RRNAME; SERIAL DIGEST-TYPE DIGEST-DATA
        </t>
      </section>
    </section>

    <section title="Calculating Zone Message Digest" anchor="calculating">
      <t>
      </t>
    </section>

    <section title="Interaction with DNSSEC" anchor="signing">
      <t>
        1. insert "dummy" &RRNAME; record and dummy RRSIG over &RRNAME;
        2. foreach ZSK, sign the zone.
        3. calculate the digest.
        4. update the &RRNAME; RDATA.
        5. foreach ZSK, update &RRNAME; RRISG.
      </t>
    </section>

    <section title="Validating Zone Message Digest" anchor="validating">
      <t>
      </t>
    </section>

    <section title="IANA Considerations" anchor="iana">
      <t>
      </t>
    </section>

    <section title="Security Considerations" anchor="security">
      <t>TBD</t>
    </section>

    <section title="Privacy Considerations" anchor="privacy">
      <t>TBD</t>
    </section>

    <section title="Acknowledgments" anchor="acknowledgments">
      <t>
        Thanks to ...
      </t>
    </section>

    <section anchor="Implementation" title="Implementation Status">
      <t>
      </t>
    </section>

  </middle>
  <back>

    <references title="Normative References">
    &RFC2119;
    &RFC1034;
    &RFC1035;
    &RFC4033;
    &RFC4034;
    &RFC4035;
    &RFC6891;
    </references>

    <references title="Informative References">
    &RFC5011;
    </references>

  </back>
</rfc>
